!function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery"],t):window.jQuery&&!window.jQuery.fn.iconpicker&&t(window.jQuery)}(function(t){"use strict";var i=function(t){return!1===t||""===t||null==t},e=function(i){return t(i).length>0},n=function(t){return"string"==typeof t||t instanceof String},o=function(i,e){return-1!==t.inArray(i,e)},s=function(i,n){this._id=s._idCounter++,this.element=t(i).addClass("iconpicker-element"),this._trigger("iconpickerCreate",{iconpickerValue:this.iconpickerValue}),this.options=t.extend({},s.defaultOptions,this.element.data(),n),this.options.templates=t.extend({},s.defaultOptions.templates,this.options.templates),this.options.originalPlacement=this.options.placement,this.container=!!e(this.options.container)&&t(this.options.container),!1===this.container&&(this.element.is(".dropdown-toggle")?this.container=t("~ .dropdown-menu:first",this.element):this.container=this.element.is("input,textarea,button,.btn")?this.element.parent():this.element),this.container.addClass("iconpicker-container"),this.isDropdownMenu()&&(this.options.placement="inline"),this.input=!!this.element.is("input,textarea")&&this.element.addClass("iconpicker-input"),!1===this.input&&(this.input=this.container.find(this.options.input),this.input.is("input,textarea")||(this.input=!1)),this.component=this.isDropdownMenu()?this.container.parent().find(this.options.component):this.container.find(this.options.component),0===this.component.length?this.component=!1:this.component.find("i").addClass("iconpicker-component"),this._createPopover(),this._createIconpicker(),0===this.getAcceptButton().length&&(this.options.mustAccept=!1),this.isInputGroup()?this.container.parent().append(this.popover):this.container.append(this.popover),this._bindElementEvents(),this._bindWindowEvents(),this.update(this.options.selected),this.isInline()&&this.show(),this._trigger("iconpickerCreated",{iconpickerValue:this.iconpickerValue})};s._idCounter=0,s.defaultOptions={title:!1,selected:!1,defaultValue:!1,placement:"bottom",collision:"none",animation:!0,hideOnSelect:!1,showFooter:!1,searchInFooter:!1,mustAccept:!1,selectedCustomClass:"bg-primary",icons:[],fullClassFormatter:function(t){return t},input:"input,.iconpicker-input",inputSearch:!1,container:!1,component:".input-group-addon,.iconpicker-component",templates:{popover:'<div class="iconpicker-popover popover"><div class="arrow"></div><div class="popover-title"></div><div class="popover-content"></div></div>',footer:'<div class="popover-footer"></div>',buttons:'<button class="iconpicker-btn iconpicker-btn-cancel btn btn-default btn-sm">Cancel</button> <button class="iconpicker-btn iconpicker-btn-accept btn btn-primary btn-sm">Accept</button>',search:'<input type="search" class="form-control iconpicker-search" placeholder="Type to filter" />',iconpicker:'<div class="iconpicker"><div class="iconpicker-items"></div></div>',iconpickerItem:'<a role="button" href="javascript:;" class="iconpicker-item"><i></i></a>'}},s.batch=function(i,e){var n=Array.prototype.slice.call(arguments,2);return t(i).each(function(){var i=t(this).data("iconpicker");i&&i[e].apply(i,n)})},s.prototype={constructor:s,options:{},_id:0,_trigger:function(i,e){e=e||{},this.element.trigger(t.extend({type:i,iconpickerInstance:this},e))},_createPopover:function(){this.popover=t(this.options.templates.popover);var e=this.popover.find(".popover-title");if(this.options.title&&e.append(t('<div class="popover-title-text">'+this.options.title+"</div>")),this.hasSeparatedSearchInput()&&!this.options.searchInFooter?e.append(this.options.templates.search):this.options.title||e.remove(),this.options.showFooter&&!i(this.options.templates.footer)){var n=t(this.options.templates.footer);this.hasSeparatedSearchInput()&&this.options.searchInFooter&&n.append(t(this.options.templates.search)),i(this.options.templates.buttons)||n.append(t(this.options.templates.buttons)),this.popover.append(n)}return!0===this.options.animation&&this.popover.addClass("fade"),this.popover},_createIconpicker:function(){var i=this;this.iconpicker=t(this.options.templates.iconpicker);var e=function(e){var n=t(this);n.is("i")&&(n=n.parent()),i._trigger("iconpickerSelect",{iconpickerItem:n,iconpickerValue:i.iconpickerValue}),!1===i.options.mustAccept?(i.update(n.data("iconpickerValue")),i._trigger("iconpickerSelected",{iconpickerItem:this,iconpickerValue:i.iconpickerValue})):i.update(n.data("iconpickerValue"),!0),i.options.hideOnSelect&&!1===i.options.mustAccept&&i.hide()},n=t(this.options.templates.iconpickerItem),o=[];for(var s in this.options.icons)if("string"==typeof this.options.icons[s].title){var r=n.clone();if(r.find("i").addClass(this.options.fullClassFormatter(this.options.icons[s].title)),r.data("iconpickerValue",this.options.icons[s].title).on("click.iconpicker",e),r.attr("title","."+this.options.icons[s].title),this.options.icons[s].searchTerms.length>0){for(var c="",p=0;p<this.options.icons[s].searchTerms.length;p++)c=c+this.options.icons[s].searchTerms[p]+" ";r.attr("data-search-terms",c)}o.push(r)}return this.iconpicker.find(".iconpicker-items").append(o),this.popover.find(".popover-content").append(this.iconpicker),this.iconpicker},_isEventInsideIconpicker:function(i){var e=t(i.target);return!((!e.hasClass("iconpicker-element")||e.hasClass("iconpicker-element")&&!e.is(this.element))&&0===e.parents(".iconpicker-popover").length)},_bindElementEvents:function(){var i=this;this.getSearchInput().on("keyup.iconpicker",function(){i.filter(t(this).val().toLowerCase())}),this.getAcceptButton().on("click.iconpicker",function(){var t=i.iconpicker.find(".iconpicker-selected").get(0);i.update(i.iconpickerValue),i._trigger("iconpickerSelected",{iconpickerItem:t,iconpickerValue:i.iconpickerValue}),i.isInline()||i.hide()}),this.getCancelButton().on("click.iconpicker",function(){i.isInline()||i.hide()}),this.element.on("focus.iconpicker",function(t){i.show(),t.stopPropagation()}),this.hasComponent()&&this.component.on("click.iconpicker",function(){i.toggle()}),this.hasInput()&&this.input.on("keyup.iconpicker",function(e){o(e.keyCode,[38,40,37,39,16,17,18,9,8,91,93,20,46,186,190,46,78,188,44,86])?i._updateFormGroupStatus(!1!==i.getValid(this.value)):i.update(),!0===i.options.inputSearch&&i.filter(t(this).val().toLowerCase())})},_bindWindowEvents:function(){var i=t(window.document),e=this,n=".iconpicker.inst"+this._id;t(window).on("resize.iconpicker"+n+" orientationchange.iconpicker"+n,function(t){e.popover.hasClass("in")&&e.updatePlacement()}),e.isInline()||i.on("mouseup"+n,function(t){e._isEventInsideIconpicker(t)||e.isInline()||e.hide()})},_unbindElementEvents:function(){this.popover.off(".iconpicker"),this.element.off(".iconpicker"),this.hasInput()&&this.input.off(".iconpicker"),this.hasComponent()&&this.component.off(".iconpicker"),this.hasContainer()&&this.container.off(".iconpicker")},_unbindWindowEvents:function(){t(window).off(".iconpicker.inst"+this._id),t(window.document).off(".iconpicker.inst"+this._id)},updatePlacement:function(i,e){i=i||this.options.placement,this.options.placement=i,e=!0===(e=e||this.options.collision)?"flip":e;var n={at:"right bottom",my:"right top",of:this.hasInput()&&!this.isInputGroup()?this.input:this.container,collision:!0===e?"flip":e,within:window};if(this.popover.removeClass("inline topLeftCorner topLeft top topRight topRightCorner rightTop right rightBottom bottomRight bottomRightCorner bottom bottomLeft bottomLeftCorner leftBottom left leftTop"),"object"==typeof i)return this.popover.pos(t.extend({},n,i));switch(i){case"inline":n=!1;break;case"topLeftCorner":n.my="right bottom",n.at="left top";break;case"topLeft":n.my="left bottom",n.at="left top";break;case"top":n.my="center bottom",n.at="center top";break;case"topRight":n.my="right bottom",n.at="right top";break;case"topRightCorner":n.my="left bottom",n.at="right top";break;case"rightTop":n.my="left bottom",n.at="right center";break;case"right":n.my="left center",n.at="right center";break;case"rightBottom":n.my="left top",n.at="right center";break;case"bottomRightCorner":n.my="left top",n.at="right bottom";break;case"bottomRight":n.my="right top",n.at="right bottom";break;case"bottom":n.my="center top",n.at="center bottom";break;case"bottomLeft":n.my="left top",n.at="left bottom";break;case"bottomLeftCorner":n.my="right top",n.at="left bottom";break;case"leftBottom":n.my="right top",n.at="left center";break;case"left":n.my="right center",n.at="left center";break;case"leftTop":n.my="right bottom",n.at="left center";break;default:return!1}return this.popover.css({display:"inline"===this.options.placement?"":"block"}),!1!==n?this.popover.pos(n).css("maxWidth",t(window).width()-this.container.offset().left-5):this.popover.css({top:"auto",right:"auto",bottom:"auto",left:"auto",maxWidth:"none"}),this.popover.addClass(this.options.placement),!0},_updateComponents:function(){if(this.iconpicker.find(".iconpicker-item.iconpicker-selected").removeClass("iconpicker-selected "+this.options.selectedCustomClass),this.iconpickerValue&&this.iconpicker.find("."+this.options.fullClassFormatter(this.iconpickerValue).replace(/ /g,".")).parent().addClass("iconpicker-selected "+this.options.selectedCustomClass),this.hasComponent()){var t=this.component.find("i");t.length>0?t.attr("class",this.options.fullClassFormatter(this.iconpickerValue)):this.component.html(this.getHtml())}},_updateFormGroupStatus:function(t){return!!this.hasInput()&&(!1!==t?this.input.parents(".form-group:first").removeClass("has-error"):this.input.parents(".form-group:first").addClass("has-error"),!0)},getValid:function(i){n(i)||(i="");var e=""===i;i=t.trim(i);for(var o=!1,s=0;s<this.options.icons.length;s++)if(this.options.icons[s].title===i){o=!0;break}return!(!o&&!e)&&i},setValue:function(t){var i=this.getValid(t);return!1!==i?(this.iconpickerValue=i,this._trigger("iconpickerSetValue",{iconpickerValue:i}),this.iconpickerValue):(this._trigger("iconpickerInvalid",{iconpickerValue:t}),!1)},getHtml:function(){return'<i class="'+this.options.fullClassFormatter(this.iconpickerValue)+'"></i>'},setSourceValue:function(t){return!1!==(t=this.setValue(t))&&""!==t&&(this.hasInput()?this.input.val(this.iconpickerValue):this.element.data("iconpickerValue",this.iconpickerValue),this._trigger("iconpickerSetSourceValue",{iconpickerValue:t})),t},getSourceValue:function(t){var i=t=t||this.options.defaultValue;return void 0!==(i=this.hasInput()?this.input.val():this.element.data("iconpickerValue"))&&""!==i&&null!==i&&!1!==i||(i=t),i},hasInput:function(){return!1!==this.input},isInputSearch:function(){return this.hasInput()&&!0===this.options.inputSearch},isInputGroup:function(){return this.container.is(".input-group")},isDropdownMenu:function(){return this.container.is(".dropdown-menu")},hasSeparatedSearchInput:function(){return!1!==this.options.templates.search&&!this.isInputSearch()},hasComponent:function(){return!1!==this.component},hasContainer:function(){return!1!==this.container},getAcceptButton:function(){return this.popover.find(".iconpicker-btn-accept")},getCancelButton:function(){return this.popover.find(".iconpicker-btn-cancel")},getSearchInput:function(){return this.popover.find(".iconpicker-search")},filter:function(e){if(i(e))return this.iconpicker.find(".iconpicker-item").show(),t(!1);var n=[];return this.iconpicker.find(".iconpicker-item").each(function(){var i=t(this),o=i.attr("title").toLowerCase();o=o+" "+(i.attr("data-search-terms")?i.attr("data-search-terms").toLowerCase():"");var s=!1;try{s=new RegExp("(^|\\W)"+e,"g")}catch(t){s=!1}!1!==s&&o.match(s)?(n.push(i),i.show()):i.hide()}),n},show:function(){if(this.popover.hasClass("in"))return!1;t.iconpicker.batch(t(".iconpicker-popover.in:not(.inline)").not(this.popover),"hide"),this._trigger("iconpickerShow",{iconpickerValue:this.iconpickerValue}),this.updatePlacement(),this.popover.addClass("in"),setTimeout(t.proxy(function(){this.popover.css("display",this.isInline()?"":"block"),this._trigger("iconpickerShown",{iconpickerValue:this.iconpickerValue})},this),this.options.animation?300:1)},hide:function(){if(!this.popover.hasClass("in"))return!1;this._trigger("iconpickerHide",{iconpickerValue:this.iconpickerValue}),this.popover.removeClass("in"),setTimeout(t.proxy(function(){this.popover.css("display","none"),this.getSearchInput().val(""),this.filter(""),this._trigger("iconpickerHidden",{iconpickerValue:this.iconpickerValue})},this),this.options.animation?300:1)},toggle:function(){this.popover.is(":visible")?this.hide():this.show(!0)},update:function(t,i){return t=t||this.getSourceValue(this.iconpickerValue),this._trigger("iconpickerUpdate",{iconpickerValue:this.iconpickerValue}),!0===i?t=this.setValue(t):(t=this.setSourceValue(t),this._updateFormGroupStatus(!1!==t)),!1!==t&&this._updateComponents(),this._trigger("iconpickerUpdated",{iconpickerValue:this.iconpickerValue}),t},destroy:function(){this._trigger("iconpickerDestroy",{iconpickerValue:this.iconpickerValue}),this.element.removeData("iconpicker").removeData("iconpickerValue").removeClass("iconpicker-element"),this._unbindElementEvents(),this._unbindWindowEvents(),t(this.popover).remove(),this._trigger("iconpickerDestroyed",{iconpickerValue:this.iconpickerValue})},disable:function(){return!!this.hasInput()&&(this.input.prop("disabled",!0),!0)},enable:function(){return!!this.hasInput()&&(this.input.prop("disabled",!1),!0)},isDisabled:function(){return!!this.hasInput()&&!0===this.input.prop("disabled")},isInline:function(){return"inline"===this.options.placement||this.popover.hasClass("inline")}},t.iconpicker=s,t.fn.iconpicker=function(i){return this.each(function(){var e=t(this);e.data("iconpicker")||e.data("iconpicker",new s(this,"object"==typeof i?i:{}))})},s.defaultOptions=t.extend(s.defaultOptions)});
